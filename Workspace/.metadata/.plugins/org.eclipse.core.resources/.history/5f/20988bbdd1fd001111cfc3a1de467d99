mongoose = require('mongoose')
Schema = mongoose.Schema
ObjectId = Schema.ObjectId

###
Schema representing a saleable product. The product record is used in conjunction with the In-App Purchase Processes.
@note
  MongoDB Collection
    db.products
@note
  MongoDB Indexes
    db.products.ensureIndex({ name: 1 }, { unique: true })
    db.products.ensureIndex({ manufacturer: 1, model: 1 })
    
@author Nathan Klick
@copyright QRef 2012
@abstract
###
class ProductSchemaInternal 
	name:
		type: String
		required: true
	description: 
		type: String
		required: false
		default: ''
	isPublished:
		type: Boolean
		required: true
		default: false
	appleProductIdentifier:
		type: String
		required: false
	androidProductIdentifier:
		type: String
		required: false
	isAppleEnabled:
		type: Boolean
		required: true
		default: false
	isAndroidEnabled:
		type: Boolean
		required: true
		default: false
	suggestedRetailPrice:
		type: Number
		required: true
		default: 0
		min: 0
		max: 100.00
	productCategory:
		type: String
		required: true
		enum: ['aviation', 'marine', 'navigation']
	productType:
		type: String
		required: true
		enum: ['checklist', 'manual', 'guide']
	aircraftChecklist:
		type: ObjectId
		ref: 'aircraft.checklists'
		required: false
		default: null
	isSampleProduct:
		type: Boolean
		required: true
		default: false
	serialNumber: 
		type: String
		required: false
		default: null
	manufacturer: 
		type: ObjectId
		ref: 'aircraft.manufacturers'
		required: true
	model: 
		type: ObjectId
		ref: 'aircraft.models'
		required: true
	coverImage:
		type: String
		required: false
	productIcon:
		type: String
		required: false
	
	
ProductSchema = new Schema(new ProductSchemaInternal())
ProductSchema.index({ manufacturer: 1, model: 1 })
ProductSchema.index({ name: 1, }, { unique: true })
module.exports = ProductSchema